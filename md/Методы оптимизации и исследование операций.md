# Методы оптимизации и исследование операций

## 1. Дифференцируемые функционалы. Производная по направлению, по Лагранжу, Гато и Фреше. Экстремум дифференцируемых функционалов. Единственность производной Фреше. Принцип Ферма и сопутствующие утверждения.

### Дифференцируемые функционалы

**Функционал** — это отображение F: X → ℝ, где X — некоторое функциональное пространство. Функционал ставит в соответствие функции число.

### Производные функционалов

1. **Производная по направлению**:
   Приращение функционала F[x + αh] - F[x] при α → 0 пропорционально α с коэффициентом δF[x, h], который называется вариацией функционала:
   ```
   lim(α→0) (F[x + αh] - F[x])/α = δF[x, h]
   ```

2. **Производная по Лагранжу (первая вариация)**:
   Основной инструмент вариационного исчисления, определяется как линейная часть приращения функционала:
   ```
   δF[x; h] = d/dα F[x + αh]|α=0
   ```

3. **Производная Гато**:
   Обобщение понятия производной на функциональные пространства:
   ```
   δF[x; h] = lim(α→0) (F[x + αh] - F[x])/α
   ```
   если этот предел существует.

4. **Производная Фреше**:
   Более сильное понятие дифференцируемости, требующее равномерной сходимости по всем направлениям:
   ```
   F[x + h] - F[x] = L[h] + o(||h||)
   ```
   где L[h] — линейный функционал, а o(||h||)/||h|| → 0 при ||h|| → 0.

### Единственность производной Фреше

Если функционал F дифференцируем по Фреше в точке x, то его производная Фреше L[h] в этой точке единственна. Это следует из свойств линейности и непрерывности производной Фреше.

### Экстремум дифференцируемых функционалов

Функционал F достигает экстремума в точке x₀, если для любого допустимого направления h значение функционала не улучшается при малых смещениях в этом направлении.

### Принцип Ферма

**Принцип Ферма**: Если функционал F достигает экстремума в точке x₀ и дифференцируем в этой точке, то его первая вариация (производная по Лагранжу) равна нулю:
```
δF[x₀; h] = 0
```
для всех допустимых направлений h.

**Сопутствующие утверждения**:
1. Необходимое условие экстремума: если x₀ — точка локального экстремума и F дифференцируем по Фреше в x₀, то F'(x₀) = 0.
2. Если F'(x₀) ≠ 0, то x₀ не является точкой экстремума.
3. Обращение производной в ноль является лишь необходимым, но не достаточным условием экстремума.

## 2. Постановка простейшей задачи вариационного исчисления. Основные леммы вариационного исчисления. Гладкость экстремали. Вывод уравнения Эйлера для классической задачи вариационного исчисления. Специальные случаи уравнения Эйлера.

### Постановка простейшей задачи вариационного исчисления

Простейшая задача вариационного исчисления заключается в нахождении функции y = y(x), x ∈ [a, b], которая доставляет экстремум (минимум или максимум) функционалу:
```
J[y] = ∫ᵃᵇ F(x, y, y')dx
```
при граничных условиях:
```
y(a) = A, y(b) = B
```
где F(x, y, y') — заданная функция, трижды непрерывно дифференцируемая по всем аргументам.

### Основные леммы вариационного исчисления

1. **Лемма Дюбуа-Реймона**: Если функция p(x) непрерывна на [a, b] и 
   ```
   ∫ᵃᵇ p(x)η(x)dx = 0
   ```
   для любой функции η(x) с непрерывной производной, обращающейся в нуль на концах отрезка, то p(x) ≡ 0 на [a, b].

2. **Основная лемма вариационного исчисления**: Если для непрерывной функции g(x) на [a, b]
   ```
   ∫ᵃᵇ g(x)η(x)dx = 0
   ```
   для любой непрерывной функции η(x), обращающейся в нуль на концах отрезка, то g(x) ≡ 0 на [a, b].

### Гладкость экстремали

Экстремаль задачи вариационного исчисления обладает определенной гладкостью, которая зависит от гладкости подынтегральной функции F. Если F имеет непрерывные частные производные до k-го порядка включительно, то экстремаль имеет непрерывные производные до порядка k+1.

### Вывод уравнения Эйлера

Пусть y = y(x) — экстремаль функционала J[y]. Рассмотрим вариацию функционала в направлении η(x), где η(a) = η(b) = 0:
```
δJ[y; η] = d/dα J[y + αη]|α=0 = ∫ᵃᵇ (∂F/∂y · η + ∂F/∂y' · η')dx
```

Интегрируя по частям второе слагаемое:
```
∫ᵃᵇ ∂F/∂y' · η'dx = [∂F/∂y' · η]ᵃᵇ - ∫ᵃᵇ d/dx(∂F/∂y') · ηdx = - ∫ᵃᵇ d/dx(∂F/∂y') · ηdx
```
поскольку η(a) = η(b) = 0.

Тогда вариация функционала:
```
δJ[y; η] = ∫ᵃᵇ (∂F/∂y - d/dx(∂F/∂y')) · ηdx
```

По принципу Ферма, δJ[y; η] = 0 для всех допустимых η. Применяя основную лемму вариационного исчисления, получаем уравнение Эйлера:
```
∂F/∂y - d/dx(∂F/∂y') = 0
```

### Специальные случаи уравнения Эйлера

1. **F не зависит явно от y**: F = F(x, y')
   
   Уравнение Эйлера принимает вид:
   ```
   d/dx(∂F/∂y') = 0
   ```
   Это означает, что ∂F/∂y' = C (константа). Это первый интеграл уравнения Эйлера.

2. **F не зависит явно от x**: F = F(y, y')
   
   Уравнение Эйлера имеет первый интеграл:
   ```
   F - y' · ∂F/∂y' = C
   ```
   (Интеграл Бельтрами)

3. **F = F(x, y)** (нет зависимости от производной)
   
   Уравнение Эйлера упрощается до:
   ```
   ∂F/∂y = 0
   ```

4. **F = G(y')** (зависит только от производной)
   
   Уравнение Эйлера: ∂G/∂y' = C, что дает y' = const, то есть y = Cx + D, где C и D определяются из граничных условий.

## 3. Уравнение Эйлера в многомерном случае.

### Постановка задачи в многомерном случае

В многомерном случае рассматривается функционал:
```
J[u] = ∫∫...∫ F(x₁, x₂, ..., xₙ, u, ∂u/∂x₁, ∂u/∂x₂, ..., ∂u/∂xₙ)dx₁dx₂...dxₙ
```
где интегрирование ведется по некоторой области D в ℝⁿ, а u = u(x₁, x₂, ..., xₙ) — искомая функция с заданными граничными условиями на границе области D.

### Вывод уравнения Эйлера в многомерном случае

Аналогично одномерному случаю, рассматривается вариация функционала:
```
δJ[u; η] = ∫∫...∫ (∂F/∂u · η + ∂F/∂(∂u/∂x₁) · ∂η/∂x₁ + ... + ∂F/∂(∂u/∂xₙ) · ∂η/∂xₙ)dx₁dx₂...dxₙ
```

Применяя теорему о дивергенции к слагаемым с производными вариации и учитывая, что вариация η обращается в нуль на границе области, получаем:
```
δJ[u; η] = ∫∫...∫ [∂F/∂u - Σᵢ ∂/∂xᵢ(∂F/∂(∂u/∂xᵢ))] · η dx₁dx₂...dxₙ
```

По аналогии с основной леммой вариационного исчисления, для произвольной вариации η выражение в квадратных скобках должно быть равно нулю, что приводит к уравнению Эйлера в многомерном случае:
```
∂F/∂u - Σᵢ ∂/∂xᵢ(∂F/∂(∂u/∂xᵢ)) = 0
```

### Частные случаи

1. **Уравнение Пуассона**:
   Если F = (1/2)Σᵢ(∂u/∂xᵢ)² - fu, то уравнение Эйлера имеет вид:
   ```
   -Δu = f
   ```
   где Δu = Σᵢ ∂²u/∂xᵢ² — оператор Лапласа.

2. **Уравнение минимальной поверхности**:
   Для функционала площади поверхности:
   ```
   J[u] = ∫∫ √(1 + (∂u/∂x)² + (∂u/∂y)²)dxdy
   ```
   уравнение Эйлера выглядит как:
   ```
   ∂/∂x(∂u/∂x/√(1 + (∂u/∂x)² + (∂u/∂y)²)) + ∂/∂y(∂u/∂y/√(1 + (∂u/∂x)² + (∂u/∂y)²)) = 0
   ```

### Векторный случай

Если искомая функция является вектор-функцией u = (u₁, u₂, ..., uₘ), то для каждой компоненты uⱼ имеем отдельное уравнение Эйлера:
```
∂F/∂uⱼ - Σᵢ ∂/∂xᵢ(∂F/∂(∂uⱼ/∂xᵢ)) = 0, j = 1, 2, ..., m
```

## 4. Постановка конечномерных задач без ограничений и с ограничениями типа равенств. Принцип Лагранжа. Необходимые и достаточные условия экстремума второго порядка.

### Задачи без ограничений

Рассматривается задача нахождения экстремума (минимума или максимума) функции f(x), где x ∈ ℝⁿ, без каких-либо ограничений.

#### Необходимые условия первого порядка

Если точка x* является локальным экстремумом функции f(x), и f дифференцируема в x*, то градиент функции в этой точке равен нулю:
```
∇f(x*) = 0
```

#### Необходимые условия второго порядка

Если точка x* является локальным экстремумом функции f(x), и f дважды дифференцируема в x*, то:
1. ∇f(x*) = 0
2. Матрица вторых производных (гессиан) H(x*) в точке x* является:
   - положительно полуопределенной для минимума
   - отрицательно полуопределенной для максимума

#### Достаточные условия второго порядка

Пусть x* — критическая точка функции f(x), т.е. ∇f(x*) = 0, и f дважды дифференцируема в окрестности x*. Тогда:
1. Если гессиан H(x*) положительно определен, то x* — точка локального минимума
2. Если гессиан H(x*) отрицательно определен, то x* — точка локального максимума
3. Если гессиан H(x*) имеет и положительные, и отрицательные собственные значения, то x* — седловая точка

### Задачи с ограничениями типа равенств

Рассматривается задача нахождения экстремума функции f(x), где x ∈ ℝⁿ, при наличии m ограничений типа равенств:
```
g₁(x) = 0, g₂(x) = 0, ..., gₘ(x) = 0
```
или в векторной форме: g(x) = 0, где g: ℝⁿ → ℝᵐ.

### Принцип Лагранжа

Для решения задач с ограничениями вводится функция Лагранжа:
```
L(x, λ) = f(x) + λ₁g₁(x) + λ₂g₂(x) + ... + λₘgₘ(x) = f(x) + λᵀg(x)
```
где λ = (λ₁, λ₂, ..., λₘ) — вектор множителей Лагранжа.

**Принцип Лагранжа (необходимые условия первого порядка)**: Если точка x* является локальным экстремумом функции f(x) при ограничениях g(x) = 0, и в точке x* выполнено условие регулярности ограничений (якобиан ∇g(x*) имеет ранг m), то существует вектор множителей Лагранжа λ* такой, что:
```
∇ₓL(x*, λ*) = 0
g(x*) = 0
```

### Необходимые и достаточные условия второго порядка для задач с ограничениями

#### Необходимые условия второго порядка

Пусть x* — точка локального экстремума функции f(x) при ограничениях g(x) = 0, и выполнены условия принципа Лагранжа. Тогда для любого вектора h такого, что ∇g(x*)h = 0 (h принадлежит касательному пространству к множеству ограничений), выполняется:
```
hᵀ∇²ₓₓL(x*, λ*)h ≥ 0 для минимума
hᵀ∇²ₓₓL(x*, λ*)h ≤ 0 для максимума
```
где ∇²ₓₓL — матрица вторых производных функции Лагранжа по переменным x.

#### Достаточные условия второго порядка

Пусть выполнены условия принципа Лагранжа в точке (x*, λ*). Если для любого ненулевого вектора h такого, что ∇g(x*)h = 0, выполняется:
```
hᵀ∇²ₓₓL(x*, λ*)h > 0
```
то x* — точка локального минимума функции f(x) при ограничениях g(x) = 0.

Если же выполняется:
```
hᵀ∇²ₓₓL(x*, λ*)h < 0
```
то x* — точка локального максимума.

## 5. Задача Лагранжа. Постановка задачи. Теорема существования. Необходимые условия оптимальности. Достаточные условия оптимальности.

### Постановка задачи Лагранжа

Задача Лагранжа — обобщение классической задачи вариационного исчисления, в которой требуется найти функцию y(x), x ∈ [a, b], доставляющую экстремум функционалу:
```
J[y] = ∫ᵃᵇ F(x, y, y')dx
```
при наличии интегральных ограничений:
```
∫ᵃᵇ G_i(x, y, y')dx = l_i, i = 1, 2, ..., m
```
и граничных условиях:
```
y(a) = A, y(b) = B
```

### Теорема существования

**Теорема существования решения задачи Лагранжа**:
Если функции F(x, y, y') и G_i(x, y, y') непрерывны вместе со своими частными производными по y и y' до второго порядка включительно в области определения, и множество допустимых функций, удовлетворяющих ограничениям и граничным условиям, непусто и компактно в соответствующей топологии, то задача Лагранжа имеет решение.

### Необходимые условия оптимальности

Для решения задачи Лагранжа вводится расширенный функционал:
```
Φ[y] = J[y] + λ₁(∫ᵃᵇ G₁(x, y, y')dx - l₁) + ... + λₘ(∫ᵃᵇ Gₘ(x, y, y')dx - lₘ)
```
где λ₁, λ₂, ..., λₘ — постоянные множители Лагранжа.

Этот функционал можно записать как:
```
Φ[y] = ∫ᵃᵇ H(x, y, y')dx - Σᵢλᵢlᵢ
```
где H(x, y, y') = F(x, y, y') + Σᵢλᵢgᵢ(x, y, y') — функция Лагранжа (гамильтониан).

**Необходимые условия оптимальности**:
Если функция y(x) является решением задачи Лагранжа, то существуют постоянные множители λ₁, λ₂, ..., λₘ, не все равные нулю одновременно, такие, что функция y(x) удовлетворяет уравнению Эйлера для расширенного функционала:
```
∂H/∂y - d/dx(∂H/∂y') = 0
```
или в развернутом виде:
```
∂F/∂y + Σᵢλᵢ∂Gᵢ/∂y - d/dx(∂F/∂y' + Σᵢλᵢ∂Gᵢ/∂y') = 0
```

### Достаточные условия оптимальности

**Достаточные условия оптимальности для задачи Лагранжа**:
Если функция y(x) удовлетворяет необходимым условиям оптимальности с некоторыми множителями Лагранжа λ₁, λ₂, ..., λₘ, и вторая вариация расширенного функционала Φ[y] положительно (или отрицательно) определена, то y(x) доставляет локальный минимум (или максимум) исходному функционалу J[y] при заданных ограничениях.

Вторая вариация функционала Φ[y] имеет вид:
```
δ²Φ[y; η] = ∫ᵃᵇ [∂²H/∂y² · η² + 2∂²H/∂y∂y' · η·η' + ∂²H/∂y'² · η'²]dx
```

Условие Лежандра для достаточности минимума требует:
```
∂²H/∂y'² > 0 для всех x ∈ [a, b]
```

Более сильное условие Якоби связано с отсутствием сопряженных точек на интервале [a, b].

## 6. Задача с подвижными концами. Необходимое условие экстремума. Условие трансверсальности.

### Постановка задачи с подвижными концами

В задаче с подвижными концами граничные условия заданы не конкретными значениями функции, а некоторыми кривыми или поверхностями. Рассматривается функционал:
```
J[y] = ∫ᵃᵇ F(x, y, y')dx
```
где границы интервала [a, b] могут быть фиксированными или подвижными, а значения функции y(x) на границах могут принадлежать заданным кривым:
```
x = a, y ∈ N₁
x = b, y ∈ N₂
```
где N₁, N₂ — заданные кривые или поверхности.

### Необходимое условие экстремума

Основным необходимым условием экстремума остается уравнение Эйлера:
```
∂F/∂y - d/dx(∂F/∂y') = 0
```
которое должно выполняться внутри интервала [a, b].

### Условие трансверсальности

В зависимости от того, какие концы являются подвижными, формулируются различные условия трансверсальности.

#### Случай 1: Правый конец подвижен вдоль кривой y = g(x)

В этом случае условие трансверсальности имеет вид:
```
[F - y'·∂F/∂y']ₓ₌ᵦ = 0
```
или
```
[F - y'·∂F/∂y' + ∂F/∂y'·g'(x)]ₓ₌ᵦ = 0
```

#### Случай 2: Оба конца подвижны вдоль вертикальных прямых x = a и x = b

Условия трансверсальности:
```
[∂F/∂y']ₓ₌ₐ = 0
[∂F/∂y']ₓ₌ᵦ = 0
```

#### Случай 3: Оба конца подвижны вдоль заданных кривых

Если левый конец подвижен вдоль кривой y = g₁(x), а правый — вдоль y = g₂(x), то условия трансверсальности:
```
[F - y'·∂F/∂y' + ∂F/∂y'·g₁'(x)]ₓ₌ₐ = 0
[F - y'·∂F/∂y' + ∂F/∂y'·g₂'(x)]ₓ₌ᵦ = 0
```

#### Общая формулировка условия трансверсальности

В общем случае, если конец подвижен вдоль кривой, заданной уравнением φ(x, y) = 0, условие трансверсальности имеет вид:
```
[∂F/∂y' · δx - (F - y'·∂F/∂y') · δy]ₓ₌концевая_точка = 0
```
где δx и δy связаны соотношением:
```
∂φ/∂x · δx + ∂φ/∂y · δy = 0
```

Геометрически условие трансверсальности означает, что экстремаль должна пересекать граничную кривую под прямым углом (быть трансверсальной к ней), если граничная кривая не является естественной границей для данного функционала.

## 7. Условия второго порядка. Сильный и слабый экстремум. Необходимое условие Лежандра.

### Виды экстремумов в вариационном исчислении

В вариационном исчислении различают несколько видов экстремумов:

1. **Слабый экстремум**: Функция y₀(x) доставляет слабый экстремум функционалу J[y], если существует такое ε > 0, что J[y₀] ≤ J[y] (для минимума) или J[y₀] ≥ J[y] (для максимума) для всех допустимых функций y(x), удовлетворяющих условию:
   ```
   max|y(x) - y₀(x)| < ε и max|y'(x) - y₀'(x)| < ε
   ```
   То есть, функция и ее производная должны мало отличаться от экстремали.

2. **Сильный экстремум**: Функция y₀(x) доставляет сильный экстремум функционалу J[y], если существует такое ε > 0, что J[y₀] ≤ J[y] (для минимума) или J[y₀] ≥ J[y] (для максимума) для всех допустимых функций y(x), удовлетворяющих только условию:
   ```
   max|y(x) - y₀(x)| < ε
   ```
   То есть, только функция должна быть близка к экстремали, а ее производная может существенно отличаться.

### Условия второго порядка

Для анализа характера экстремума в вариационном исчислении используются условия второго порядка, связанные со второй вариацией функционала.

Вторая вариация функционала J[y] = ∫ᵃᵇ F(x, y, y')dx имеет вид:
```
δ²J[y; η] = ∫ᵃᵇ [Fₚₚ·η'² + 2Fₚₛ·η'η + Fₛₛ·η²]dx
```
где Fₚₚ = ∂²F/∂y'², Fₚₛ = ∂²F/∂y'∂y, Fₛₛ = ∂²F/∂y², а η(x) — допустимая вариация, обращающаяся в нуль на концах интервала.

### Необходимое условие Лежандра

**Необходимое условие Лежандра**: Если функция y₀(x) доставляет слабый экстремум (минимум или максимум) функционалу J[y], то для всех x ∈ [a, b] должно выполняться условие:
```
Fₚₚ(x, y₀(x), y₀'(x)) ≥ 0 для минимума
Fₚₚ(x, y₀(x), y₀'(x)) ≤ 0 для максимума
```

Если хотя бы в одной точке интервала [a, b] условие Лежандра нарушается, то функция y₀(x) не может быть экстремалью.

Если для всех x ∈ [a, b] выполняется строгое неравенство:
```
Fₚₚ(x, y₀(x), y₀'(x)) > 0
```
то говорят, что выполнено усиленное условие Лежандра.

### Усиление необходимых условий

Условие Лежандра является лишь необходимым условием слабого экстремума. Для более полного анализа используются также:

1. **Условие Якоби**: Связано с отсутствием сопряженных точек на интервале [a, b].

2. **Условие Вейерштрасса**: Необходимое условие сильного экстремума, связанное с функцией Вейерштрасса:
   ```
   E(x, y, p, q) = F(x, y, q) - F(x, y, p) - (q - p)·∂F/∂y'(x, y, p)
   ```

### Достаточные условия экстремума

Для того чтобы функция y₀(x), удовлетворяющая уравнению Эйлера, доставляла минимум функционалу J[y], достаточно, чтобы:
1. Выполнялось усиленное условие Лежандра: Fₚₚ > 0 на [a, b]
2. Не было сопряженных точек на [a, b] (условие Якоби)
3. Функция Вейерштрасса E(x, y₀, y₀', q) ≥ 0 для всех допустимых q (для сильного минимума)

## 8. Уравнение Якоби и свойства его решений. Сопряженные точки. Свойство знакопостоянства второй производной.

### Уравнение Якоби

Уравнение Якоби возникает при исследовании второй вариации функционала и играет ключевую роль в определении достаточных условий экстремума в вариационном исчислении.

Для функционала J[y] = ∫ᵃᵇ F(x, y, y')dx и экстремали y₀(x) уравнение Якоби имеет вид:
```
d/dx[Fₚₚ(x)·u'] - Fₚₛ(x)·u' + Fₛₚ(x)·u' - Fₛₛ(x)·u = 0
```
или в более компактной форме:
```
(Fₚₚ·u')' - Fₚₛ·u' - Fₛₚ·u' + Fₛₛ·u = 0
```
где u = u(x) — искомая функция, а Fₚₚ, Fₚₛ, Fₛₚ, Fₛₛ вычисляются на экстремали y₀(x).

### Свойства решений уравнения Якоби

1. **Линейность**: Уравнение Якоби — линейное дифференциальное уравнение второго порядка, поэтому его общее решение представляется в виде:
   ```
   u(x) = C₁u₁(x) + C₂u₂(x)
   ```
   где u₁(x) и u₂(x) — линейно независимые частные решения.

2. **Тривиальное решение**: Одним из решений уравнения Якоби всегда является функция u₁(x) = y₀'(x), где y₀(x) — экстремаль исходного функционала.

3. **Осцилляционные свойства**: Для многих задач решения уравнения Якоби имеют осцилляционный характер, что важно для определения сопряженных точек.

### Сопряженные точки

**Сопряженные точки** — это точки, в которых нетривиальное решение уравнения Якоби, обращающееся в нуль в одной из них, также обращается в нуль.

Формально: точка c ∈ (a, b] называется сопряженной к точке a, если существует нетривиальное решение u(x) уравнения Якоби такое, что u(a) = u(c) = 0.

### Теорема Якоби

**Теорема Якоби (необходимое условие)**: Если функция y₀(x) доставляет слабый экстремум функционалу J[y], то на интервале (a, b) не должно быть точек, сопряженных к точке a.

**Усиленная теорема Якоби (достаточное условие)**: Если функция y₀(x) удовлетворяет уравнению Эйлера, выполнено усиленное условие Лежандра (Fₚₚ > 0), и на интервале [a, b] нет точек, сопряженных к точке a, то y₀(x) доставляет слабый минимум функционалу J[y].

### Свойство знакопостоянства второй производной

Для функционала простейшего вида J[y] = ∫ᵃᵇ F(y')dx, где F зависит только от производной, условие Лежандра принимает вид:
```
F''(y') ≥ 0 для минимума
F''(y') ≤ 0 для максимума
```

В этом случае вторая вариация функционала имеет вид:
```
δ²J[y; η] = ∫ᵃᵇ F''(y')·η'²dx
```

Если F''(y') > 0 на всем отрезке [a, b], то вторая вариация положительна для любой ненулевой вариации η(x), удовлетворяющей граничным условиям. Это означает, что экстремаль доставляет функционалу минимум.

Аналогично, если F''(y') < 0 на всем отрезке [a, b], то экстремаль доставляет функционалу максимум.

Таким образом, свойство знакопостоянства второй производной функции F по y' является важным критерием при определении характера экстремума в задачах вариационного исчисления.